Vagrant.configure("2") do |config|

    # Let's have some variables set up front so we can modify them.
    $address        = "localhost"                   # What would be the address you will visit to view your project?
    $addressIP      = "127.0.0.1"                   # The internal IP address... Just in case.
    $index          = "index.php"                   # What file should be read.
    $logsDir        = "/vagrant/logs"               # Server side path to logs.
    $ram            = "512"                         # Amount of RAM allowed for this machine.
    $rootDir        = "/pub"                        # Local side path to the project content.
    $serverAdmin    = "webmaster@localhost"         # E-mail address for the admin. Fake will do...
    $service        = "nginx"                       # nginx|apache

    # Configure virtualbox to allow $ram-MB memory and symlinks
    config.vm.provider :virtualbox do |vb|
        vb.customize ["modifyvm", :id, "--memory", $ram]
        vb.customize ["setextradata", :id, "VBoxInternal2/SharedFoldersEnableSymlinksCreate/v-root", "1"]
    end

    # Use Ubuntu LTS 12.04 x32
    config.vm.box = "precise32"
    config.vm.box_url = "http://files.vagrantup.com/precise32.box"

    # Set up network for HTTP/HTTPS and MySQL
    config.vm.network :forwarded_port, guest: 80, host: 8080
    config.vm.network :forwarded_port, guest: 443, host: 8443
    config.vm.network :forwarded_port, guest: 1080, host: 1080
    config.vm.network :forwarded_port, guest: 3306, host: 3306

    # config.vm.synced_folder("vagrant-root", "/vagrant", ".", :owner => 'vagrant', :group => 'vagrant', :extra => 'dmode=777,fmode=777')

    # Load up all the modules
    config.vm.provision :puppet do |puppet|
        puppet.manifests_path = "vagrant/manifests"
        puppet.manifest_file = "default.pp"
        puppet.module_path = "vagrant/modules"

        # Pass the variables through!
        puppet.facter = {
              "address"     => $address,
              "addressIP"   => $addressIP,
              "index"       => $index,
              "logsDir"     => $logsDir,
              "ram"         => $ram,
              "rootDir"     => $rootDir,
              "serverAdmin" => $serverAdmin,
              "service"     => $service,
            }
    end
end
